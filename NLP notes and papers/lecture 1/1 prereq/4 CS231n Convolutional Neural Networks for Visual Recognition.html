<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CS231n Convolutional Neural Networks for Visual Recognition</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Course materials and notes for Stanford class CS231n: Convolutional Neural Networks for Visual Recognition.">
    <link rel="canonical" href="http://cs231n.github.io/optimization-1/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/main.css">

    <!-- Google fonts -->
    <link href="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/css.css" rel="stylesheet" type="text/css">

    <!-- Google tracking -->
    <script async="" src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/analytics.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46895817-2', 'auto');
      ga('send', 'pageview');

    </script>
    
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>


    <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    <header class="site-header">

  <div class="wrap title-wrap">
    <a class="site-title" href="http://cs231n.github.io/">CS231n Convolutional Neural Networks for Visual Recognition</a>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1></h1>
  </header>

  <article class="post-content">
  <p>Table of Contents:</p>

<ul>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#vis">Visualizing the loss function</a></li>
  <li><a href="#optimization">Optimization</a>
    <ul>
      <li><a href="#opt1">Strategy #1: Random Search</a></li>
      <li><a href="#opt2">Strategy #2: Random Local Search</a></li>
      <li><a href="#opt3">Strategy #3: Following the gradient</a></li>
    </ul>
  </li>
  <li><a href="#gradcompute">Computing the gradient</a>
    <ul>
      <li><a href="#numerical">Numerically with finite differences</a></li>
      <li><a href="#analytic">Analytically with calculus</a></li>
    </ul>
  </li>
  <li><a href="#gd">Gradient descent</a></li>
  <li><a href="#summary">Summary</a></li>
</ul>

<p><a name="intro"></a></p>

<h3 id="introduction">Introduction</h3>

<p>In the previous section we introduced two key components in context of the image classification task:</p>

<ol>
  <li>A (parameterized) <strong>score function</strong> mapping the raw image pixels to class scores (e.g. a linear function)</li>
  <li>A <strong>loss function</strong> that measured the quality of a 
particular set of parameters based on how well the induced scores agreed
 with the ground truth labels in the training data. We saw that there 
are many ways and versions of this (e.g. Softmax/SVM).</li>
</ol>

<p>Concretely, recall that the linear function had the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 7.887em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.058em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.726em, 1006.06em, 2.899em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-5"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-7" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="mo" id="MathJax-Span-10" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-11" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-14" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-15" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.332em; border-left: 0px solid; width: 0px; height: 1.276em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>W</mi><mo stretchy="false">)</mo><mo>=</mo><mi>W</mi><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1"> f(x_i, W) =  W x_i </script> and the SVM we developed was formulated as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 31.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.087em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.532em, 1024.04em, 4.599em, -1000em); top: -3.029em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-19" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-20" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.17em, 1000.39em, 4.135em, -1000em); top: -4.667em; left: 50%; margin-left: -0.25em;"><span class="mn" id="MathJax-Span-21" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.193em, 1000.73em, 4.15em, -1000em); top: -3.304em; left: 50%; margin-left: -0.363em;"><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1000.85em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.847em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="munderover" id="MathJax-Span-23" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.2em, 4.61em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-24" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.19em, 4.242em, -1000em); top: -2.84em; left: 0.548em;"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-26" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.2em, 4.61em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-27" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1001.19em, 4.411em, -1000em); top: -2.84em; left: 0.052em;"><span class="texatom" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-31" style="font-size: 70.7%; font-family: STIXGeneral;">≠</span><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-34" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mrow" id="MathJax-Span-35" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-36" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">[</span></span><span class="mrow" id="MathJax-Span-37"><span class="mo" id="MathJax-Span-38" style="font-family: STIXGeneral;">max</span><span class="mo" id="MathJax-Span-39" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-40" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-41" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-43" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral;">;</span><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.28em, 4.312em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-50" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.333em;"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-52" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-53" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.25em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: STIXGeneral;">;</span><span class="mi" id="MathJax-Span-59" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 0.914em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.28em, 4.312em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-61" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.333em;"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-66" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-68" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-69" style="font-family: STIXGeneral;">)</span></span><span class="mo" id="MathJax-Span-70" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">]</span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">α</span><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral; font-style: italic;">R</span><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-75" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="mo" id="MathJax-Span-76" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.029em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.917em; border-left: 0px solid; width: 0px; height: 3.737em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>∑</mo><mi>i</mi></munder><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></munder><mrow><mo>[</mo><mrow><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>;</mo><mi>W</mi><msub><mo stretchy="false">)</mo><mi>j</mi></msub><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>;</mo><mi>W</mi><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow><mo>+</mo><mi>α</mi><mi>R</mi><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">L = \frac{1}{N} \sum_i \sum_{j\neq y_i} \left[ \max(0, f(x_i; W)_j - f(x_i; W)_{y_i} + 1) \right] + \alpha R(W)</script>

<p>We saw that a setting of the parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">W</script> that produced predictions for examples <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 0.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1000.72em, 2.465em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="msubsup" id="MathJax-Span-82"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-83" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">x_i</script> consistent with their ground truth labels <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 0.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1000.72em, 2.514em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="msubsup" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.43em, 4.341em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">y_i</script> would also have a very low loss <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-90" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.58em, 2.692em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.974em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">L</script>. We are now going to introduce the third and last key component: <strong>optimization</strong>. Optimization is the process of finding the set of parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">W</script> that minimize the loss function.</p>

<p><strong>Foreshadowing:</strong> Once we understand how these three 
core components interact, we will revisit the first component (the 
parameterized function mapping) and extend it to functions much more 
complicated than a linear mapping: First entire Neural Networks, and 
then Convolutional Neural Networks. The loss functions and the 
optimization process will remain relatively unchanged.</p>

<p><a name="vis"></a></p>

<h3 id="visualizing-the-loss-function">Visualizing the loss function</h3>

<p>The loss functions we’ll look at in this class are usually defined 
over very high-dimensional spaces (e.g. in CIFAR-10 a linear classifier 
weight matrix is of size [10 x 3073] for a total of 30,730 parameters), 
making them difficult to visualize. However, we can still gain some 
intuitions about one by slicing through the high-dimensional space along
 rays (1 dimension), or along planes (2 dimensions). For example, we can
 generate a random weight matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-96" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">W</script>
 (which corresponds to a single point in the space), then march along a 
ray and record the loss function value along the way. That is, we can 
generate a random direction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-99" style="width: 1.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.25em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.366em, 1001.25em, 2.458em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.91em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.833em;"><span class="mn" id="MathJax-Span-103" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.258em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">W_1</script> and compute the loss along this direction by evaluating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 6.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.048em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.728em, 1005em, 2.869em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-108" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-110" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">a</span><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.91em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.833em;"><span class="mn" id="MathJax-Span-113" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.293em; border-left: 0px solid; width: 0px; height: 1.234em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>W</mi><mo>+</mo><mi>a</mi><msub><mi>W</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">L(W + a W_1)</script> for different values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.963em, 1000.46em, 2.703em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.713em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">a</script>. This process generates a simple plot with the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.963em, 1000.46em, 2.703em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.713em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">a</script>
 as the x-axis and the value of the loss function as the y-axis. We can 
also carry out the same procedure with two dimensions by evaluating the 
loss <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 10.387em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.981em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.721em, 1007.93em, 2.869em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-125" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="mo" id="MathJax-Span-126" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">a</span><span class="msubsup" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.91em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.833em;"><span class="mn" id="MathJax-Span-130" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-131" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-132" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">b</span><span class="msubsup" id="MathJax-Span-133"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.91em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-134" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.833em;"><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.293em; border-left: 0px solid; width: 0px; height: 1.243em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>W</mi><mo>+</mo><mi>a</mi><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><msub><mi>W</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13"> L(W + a W_1 + b W_2) </script> as we vary <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.394em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.721em, 1001.37em, 2.833em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-141" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.246em; border-left: 0px solid; width: 0px; height: 1.196em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">a, b</script>. In a plot, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.394em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.721em, 1001.37em, 2.833em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mo" id="MathJax-Span-145" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-146" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.246em; border-left: 0px solid; width: 0px; height: 1.196em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">a, b</script> could then correspond to the x-axis and the y-axis, and the value of the loss function can be visualized with a color:</p>

<div class="fig figcenter fighighlight">
  <img src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/svm1d.png">
  <img src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/svm_one.jpg">
  <img src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/svm_all.jpg">
  <div class="figcaption">
    Loss function landscape for the Multiclass SVM (without 
regularization) for one single example (left,middle) and for a hundred 
examples (right) in CIFAR-10. Left: one-dimensional loss by only varying
 <b>a</b>. Middle, Right: two-dimensional loss slice, Blue = low loss, 
Red = high loss. Notice the piecewise-linear structure of the loss 
function. The losses for multiple examples are combined with average, so
 the bowl shape on the right is the average of many piece-wise linear 
bowls (such as the one in the middle).
  </div>
</div>

<p>We can explain the piecewise-linear structure of the loss function by examining the math. For a single example we have:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-147" style="width: 18.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.423em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(2.102em, 1014.22em, 4.792em, -1000em); top: -3.221em; left: 0em;"><span class="mrow" id="MathJax-Span-148"><span class="msubsup" id="MathJax-Span-149"><span style="display: inline-block; position: relative; width: 0.828em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-150" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-152" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-153" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.2em, 4.61em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-154" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1001.19em, 4.411em, -1000em); top: -2.84em; left: 0.052em;"><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-158" style="font-size: 70.7%; font-family: STIXGeneral;">≠</span><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-161" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mrow" id="MathJax-Span-162" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-163" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">[</span></span></span><span class="mrow" id="MathJax-Span-164"><span class="mo" id="MathJax-Span-165" style="font-family: STIXGeneral;">max</span><span class="mo" id="MathJax-Span-166" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-167" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-168" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-169" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.385em, 1000.27em, 4.281em, -1000em); top: -3.694em; left: 0.667em;"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-174" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-175" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-176" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-177" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.58em, 4.311em, -1000em); top: -3.843em; left: 0.667em;"><span class="texatom" id="MathJax-Span-180"><span class="mrow" id="MathJax-Span-181"><span class="msubsup" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-184" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-189" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral;">)</span></span><span class="mo" id="MathJax-Span-191" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.917em; border-left: 0px solid; width: 0px; height: 3.247em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></munder><mrow><mo>[</mo><mrow><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">L_i = \sum_{j\neq y_i} \left[ \max(0, w_j^Tx_i - w_{y_i}^Tx_i + 1) \right]</script>

<p>It is clear from the equation that the data loss for each example is a sum of (zero-thresholded due to the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-192" style="width: 5.147em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.942em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.728em, 1003.89em, 2.869em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-193"><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral;">max</span><span class="mo" id="MathJax-Span-195" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-196" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-197" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-198" style="font-family: STIXGeneral; padding-left: 0.188em;">−</span><span class="mo" id="MathJax-Span-199" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.293em; border-left: 0px solid; width: 0px; height: 1.234em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mo>−</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">\max(0,-)</script> function) linear functions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-200" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">W</script>. Moreover, each row of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-203" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">W</script> (i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" style="width: 1.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1000.96em, 2.604em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-207"><span class="msubsup" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 0.939em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.667em;"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.448em; border-left: 0px solid; width: 0px; height: 1.084em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">w_j</script>)
 sometimes has a positive sign in front of it (when it corresponds to a 
wrong class for an example), and sometimes a negative sign (when it 
corresponds to the correct class for that example). To make this more 
explicit, consider a simple dataset that contains three 1-dimensional 
points and three classes. The full SVM loss (without regularization) 
becomes:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" style="width: 31.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.327em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-2.938em, 1024.11em, 6.765em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="mtable" id="MathJax-Span-213" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 23.996em; height: 0px;"><span style="position: absolute; clip: rect(5.1em, 1001.93em, 14.449em, -1000em); top: -10.048em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.983em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1001.93em, 4.295em, -1000em); top: -8.141em; right: 0em;"><span class="mtd" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mn" id="MathJax-Span-218" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.846em, 1000em, 4.135em, -1000em); top: -6.68em; right: 0em;"><span class="mtd" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.193em, 1001.93em, 4.285em, -1000em); top: -5.337em; right: 0em;"><span class="mtd" id="MathJax-Span-270"><span class="mrow" id="MathJax-Span-271"><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mn" id="MathJax-Span-274" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.846em, 1000em, 4.135em, -1000em); top: -3.876em; right: 0em;"><span class="mtd" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.193em, 1001.93em, 4.285em, -1000em); top: -2.532em; right: 0em;"><span class="mtd" id="MathJax-Span-326"><span class="mrow" id="MathJax-Span-327"><span class="msubsup" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-329" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mn" id="MathJax-Span-330" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-331" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.846em, 1000em, 4.135em, -1000em); top: -1.071em; right: 0em;"><span class="mtd" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.193em, 1001.51em, 4.135em, -1000em); top: 0.267em; right: 0em;"><span class="mtd" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-385" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.048em;"></span></span><span style="position: absolute; clip: rect(5.283em, 1021.97em, 14.963em, -1000em); top: -10.385em; left: 1.983em;"><span style="display: inline-block; position: relative; width: 22.014em; height: 0px;"><span style="position: absolute; clip: rect(3.04em, 1021.97em, 4.458em, -1000em); top: -8.141em; left: 0em;"><span class="mtd" id="MathJax-Span-220"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222"></span><span class="mo" id="MathJax-Span-223" style="font-family: STIXGeneral; padding-left: 0.188em;">max</span><span class="mo" id="MathJax-Span-224" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-225" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-226" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-227" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-230" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-233" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-234" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-235" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.145em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-238" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-243" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-244" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-245" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-246" style="font-family: STIXGeneral; padding-left: 0.25em;">max</span><span class="mo" id="MathJax-Span-247" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-248" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-250" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-251" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-253" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-255" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-256" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-257" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-258" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-259" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-260" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.145em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-261" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-264" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-266" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-267" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.04em, 1021.97em, 4.458em, -1000em); top: -5.337em; left: 0em;"><span class="mtd" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="mi" id="MathJax-Span-278"></span><span class="mo" id="MathJax-Span-279" style="font-family: STIXGeneral; padding-left: 0.188em;">max</span><span class="mo" id="MathJax-Span-280" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-281" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-282" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-283" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-284" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.145em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-288" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-289" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-290" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-291" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-292" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-294" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-295"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-296" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-297" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-298" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-299" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-300" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-302" style="font-family: STIXGeneral; padding-left: 0.25em;">max</span><span class="mo" id="MathJax-Span-303" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-304" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-305" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-306" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-307" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-309" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-310"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-312" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-313" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-314" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-319" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-321" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-322" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-323" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.04em, 1021.97em, 4.458em, -1000em); top: -2.532em; left: 0em;"><span class="mtd" id="MathJax-Span-332"><span class="mrow" id="MathJax-Span-333"><span class="mi" id="MathJax-Span-334"></span><span class="mo" id="MathJax-Span-335" style="font-family: STIXGeneral; padding-left: 0.188em;">max</span><span class="mo" id="MathJax-Span-336" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-337" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-338" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-339" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-341" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.145em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-342" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-343"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-344" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-345" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-346" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-347" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-348" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-350" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-352" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-353" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-354" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-355" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-356" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-357" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-358" style="font-family: STIXGeneral; padding-left: 0.25em;">max</span><span class="mo" id="MathJax-Span-359" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-360" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-361" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-362" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-363" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-365" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-366"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-367" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-368" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-369" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-370" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-372" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.135em, -1000em); top: -3.677em; left: 0.667em;"><span class="mn" id="MathJax-Span-373" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mn" id="MathJax-Span-376" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-377" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-378" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-379" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.17em, 1006.7em, 4.312em, -1000em); top: 0.267em; left: 0em;"><span class="mtd" id="MathJax-Span-386"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388"></span><span class="mo" id="MathJax-Span-389" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-390"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-391" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mn" id="MathJax-Span-392" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-393" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-394" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-395" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mn" id="MathJax-Span-396" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-398" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-399" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mn" id="MathJax-Span-400" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-401" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-402"><span class="mrow" id="MathJax-Span-403"><span class="mo" id="MathJax-Span-404" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-405" style="font-family: STIXGeneral;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.385em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.857em; border-left: 0px solid; width: 0px; height: 12.363em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>L</mi><mn>0</mn></msub><mo>=</mo></mtd><mtd><mi></mi><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mn>1</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>0</mn></msub><mo>−</mo><msubsup><mi>w</mi><mn>0</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mn>2</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>0</mn></msub><mo>−</mo><msubsup><mi>w</mi><mn>0</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd><msub><mi>L</mi><mn>1</mn></msub><mo>=</mo></mtd><mtd><mi></mi><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mn>0</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msubsup><mi>w</mi><mn>1</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mn>2</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msubsup><mi>w</mi><mn>1</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd><msub><mi>L</mi><mn>2</mn></msub><mo>=</mo></mtd><mtd><mi></mi><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mn>0</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>w</mi><mn>2</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mn>1</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>w</mi><mn>2</mn><mi>T</mi></msubsup><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd><mi>L</mi><mo>=</mo></mtd><mtd><mi></mi><mo stretchy="false">(</mo><msub><mi>L</mi><mn>0</mn></msub><mo>+</mo><msub><mi>L</mi><mn>1</mn></msub><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>3</mn></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">% <![CDATA[
\begin{align}
L_0 = & \max(0, w_1^Tx_0 - w_0^Tx_0 + 1) + \max(0, w_2^Tx_0 - w_0^Tx_0 + 1) \\\\
L_1 = & \max(0, w_0^Tx_1 - w_1^Tx_1 + 1) + \max(0, w_2^Tx_1 - w_1^Tx_1 + 1) \\\\
L_2 = & \max(0, w_0^Tx_2 - w_2^Tx_2 + 1) + \max(0, w_1^Tx_2 - w_2^Tx_2 + 1) \\\\
L = & (L_0 + L_1 + L_2)/3
\end{align} %]]></script>

<p>Since these examples are 1-dimensional, the data <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-406" style="width: 0.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1000.72em, 2.465em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-407"><span class="msubsup" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-409" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-410" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">x_i</script> and weights <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-411" style="width: 1.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1000.96em, 2.604em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-412"><span class="msubsup" id="MathJax-Span-413"><span style="display: inline-block; position: relative; width: 0.939em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-414" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.667em;"><span class="mi" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.448em; border-left: 0px solid; width: 0px; height: 1.084em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">w_j</script> are numbers. Looking at, for instance, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-416" style="width: 1.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1001.11em, 2.468em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-417"><span class="msubsup" id="MathJax-Span-418"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-419" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.667em;"><span class="mn" id="MathJax-Span-420" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">w_0</script>, some terms above are linear functions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-421" style="width: 1.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1001.11em, 2.468em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-422"><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.667em;"><span class="mn" id="MathJax-Span-425" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.27em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">w_0</script> and each is clamped at zero. We can visualize this as follows:</p>

<div class="fig figcenter fighighlight">
  <img src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/svmbowl.png">
  <div class="figcaption">
    1-dimensional illustration of the data loss. The x-axis is a single 
weight and the y-axis is the loss. The data loss is a sum of multiple 
terms, each of which is either independent of a particular weight, or a 
linear function of it that is thresholded at zero. The full SVM data 
loss is a 30,730-dimensional version of this shape.
  </div>
</div>

<p>As an aside, you may have guessed from its bowl-shaped appearance that the SVM cost function is an example of a <a href="http://en.wikipedia.org/wiki/Convex_function">convex function</a>
 There is a large amount of literature devoted to efficiently minimizing
 these types of functions, and you can also take a Stanford class on the
 topic ( <a href="http://stanford.edu/%7Eboyd/cvxbook/">convex optimization</a> ). Once we extend our score functions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-426" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.726em, 1000.43em, 2.899em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.332em; border-left: 0px solid; width: 0px; height: 1.276em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">f</script>
 to Neural Networks our objective functions will become non-convex, and 
the visualizations above will not feature bowls but complex, bumpy 
terrains.</p>

<p><em>Non-differentiable loss functions</em>. As a technical note, you can also see that the <em>kinks</em>
 in the loss function (due to the max operation) technically make the 
loss function non-differentiable because at these kinks the gradient is 
not defined. However, the <a href="http://en.wikipedia.org/wiki/Subderivative">subgradient</a> still exists and is commonly used instead. In this class will use the terms <em>subgradient</em> and <em>gradient</em> interchangeably.</p>

<p><a name="optimization"></a></p>

<h3 id="optimization">Optimization</h3>

<p>To reiterate, the loss function lets us quantify the quality of any particular set of weights <strong>W</strong>. The goal of optimization is to find <strong>W</strong>
 that minimizes the loss function. We will now motivate and slowly 
develop an approach to optimizing the loss function. For those of you 
coming to this class with previous experience, this section might seem 
odd since the working example we’ll use (the SVM loss) is a convex 
problem, but keep in mind that our goal is to eventually optimize Neural
 Networks where we can’t easily use any of the tools developed in the 
Convex Optimization literature.</p>

<p><a name="opt1"></a></p>

<h4 id="strategy-1-a-first-very-bad-idea-solution-random-search">Strategy #1: A first very bad idea solution: Random search</h4>

<p>Since it is so simple to check how good a given set of parameters <strong>W</strong>
 is, the first (very bad) idea that may come to mind is to simply try 
out many different random weights and keep track of what works best. 
This procedure might look as follows:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># assume X_train is the data where each column is an example (e.g. 3073 x 50,000)</span>
<span class="c"># assume Y_train are the labels (e.g. 1D array of 50,000)</span>
<span class="c"># assume the function L evaluates the loss function</span>

<span class="n">bestloss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">)</span> <span class="c"># Python assigns the highest possible float value</span>
<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
  <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3073</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.0001</span> <span class="c"># generate random parameters</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="c"># get the loss over the entire training set</span>
  <span class="k">if</span> <span class="n">loss</span> <span class="o">&lt;</span> <span class="n">bestloss</span><span class="p">:</span> <span class="c"># keep track of the best solution</span>
    <span class="n">bestloss</span> <span class="o">=</span> <span class="n">loss</span>
    <span class="n">bestW</span> <span class="o">=</span> <span class="n">W</span>
  <span class="k">print</span> <span class="s">'in attempt </span><span class="si">%</span><span class="s">d the loss was </span><span class="si">%</span><span class="s">f, best </span><span class="si">%</span><span class="s">f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">bestloss</span><span class="p">)</span>

<span class="c"># prints:</span>
<span class="c"># in attempt 0 the loss was 9.401632, best 9.401632</span>
<span class="c"># in attempt 1 the loss was 8.959668, best 8.959668</span>
<span class="c"># in attempt 2 the loss was 9.044034, best 8.959668</span>
<span class="c"># in attempt 3 the loss was 9.278948, best 8.959668</span>
<span class="c"># in attempt 4 the loss was 8.857370, best 8.857370</span>
<span class="c"># in attempt 5 the loss was 8.943151, best 8.857370</span>
<span class="c"># in attempt 6 the loss was 8.605604, best 8.605604</span>
<span class="c"># ... (trunctated: continues for 1000 lines)</span>
</code></pre>
</div>

<p>In the code above, we see that we tried out several random weight vectors <strong>W</strong>, and some of them work better than others. We can take the best weights <strong>W</strong> found by this search and try it out on the test set:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Assume X_test is [3073 x 10000], Y_test [10000 x 1]</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">Wbest</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Xte_cols</span><span class="p">)</span> <span class="c"># 10 x 10000, the class scores for all test examples</span>
<span class="c"># find the index with max score in each column (the predicted class)</span>
<span class="n">Yte_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="c"># and calculate accuracy (fraction of predictions that are correct)</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Yte_predict</span> <span class="o">==</span> <span class="n">Yte</span><span class="p">)</span>
<span class="c"># returns 0.1555</span>
</code></pre>
</div>

<p>With the best <strong>W</strong> this gives an accuracy of about <strong>15.5%</strong>.
 Given that guessing classes completely at random achieves only 10%, 
that’s not a very bad outcome for a such a brain-dead random search 
solution!</p>

<p><strong>Core idea: iterative refinement</strong>. Of course, it turns out that we can do much better. The core idea is that finding the best set of weights <strong>W</strong> is a very difficult or even impossible problem (especially once <strong>W</strong> contains weights for entire complex neural networks), but the problem of refining a specific set of weights <strong>W</strong> to be slightly better is significantly less difficult. In other words, our approach will be to start with a random <strong>W</strong> and then iteratively refine it, making it slightly better each time.</p>

<blockquote>
  <p>Our strategy will be to start with random weights and iteratively refine them over time to get lower loss</p>
</blockquote>

<p><strong>Blindfolded hiker analogy.</strong> One analogy that you may 
find helpful going forward is to think of yourself as hiking on a hilly 
terrain with a blindfold on, and trying to reach the bottom. In the 
example of CIFAR-10, the hills are 30,730-dimensional, since the 
dimensions of <strong>W</strong> are 3073 x 10. At every point on the hill we achieve a particular loss (the height of the terrain).</p>

<p><a name="opt2"></a></p>

<h4 id="strategy-2-random-local-search">Strategy #2: Random Local Search</h4>

<p>The first strategy you may think of is to try to extend one foot in a
 random direction and then take a step only if it leads downhill. 
Concretely, we will start out with a random <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-429" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">W</script>, generate random perturbations <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.394em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.736em, 1001.39em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: STIXGeneral; font-style: italic;">δ</span><span class="mi" id="MathJax-Span-435" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 1.017em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-28"> \delta W </script> to it and if the loss at the perturbed <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-436" style="width: 4.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.413em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.736em, 1003.41em, 2.733em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-437"><span class="mi" id="MathJax-Span-438" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="mo" id="MathJax-Span-439" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-440" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">δ</span><span class="mi" id="MathJax-Span-441" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.116em; border-left: 0px solid; width: 0px; height: 1.047em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi><mo>+</mo><mi>δ</mi><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">W + \delta W</script> is lower, we will perform an update. The code for this procedure is as follows:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3073</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="c"># generate random starting W</span>
<span class="n">bestloss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
  <span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.0001</span>
  <span class="n">Wtry</span> <span class="o">=</span> <span class="n">W</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3073</span><span class="p">)</span> <span class="o">*</span> <span class="n">step_size</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">Xtr_cols</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">Wtry</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">loss</span> <span class="o">&lt;</span> <span class="n">bestloss</span><span class="p">:</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">Wtry</span>
    <span class="n">bestloss</span> <span class="o">=</span> <span class="n">loss</span>
  <span class="k">print</span> <span class="s">'iter </span><span class="si">%</span><span class="s">d loss is </span><span class="si">%</span><span class="s">f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">bestloss</span><span class="p">)</span>
</code></pre>
</div>

<p>Using the same number of loss function evaluations as before (1000), this approach achieves test set classification accuracy of <strong>21.4%</strong>. This is better, but still wasteful and computationally expensive.</p>

<p><a name="opt3"></a></p>

<h4 id="strategy-3-following-the-gradient">Strategy #3: Following the Gradient</h4>

<p>In the previous section we tried to find a direction in the 
weight-space that would improve our weight vector (and give us a lower 
loss). It turns out that there is no need to randomly search for a good 
direction: we can compute the <em>best</em> direction along which we 
should change our weight vector that is mathematically guaranteed to be 
the direction of the steepest descend (at least in the limit as the step
 size goes towards zero). This direction will be related to the <strong>gradient</strong>
 of the loss function. In our hiking analogy, this approach roughly 
corresponds to feeling the slope of the hill below our feet and stepping
 down the direction that feels steepest.</p>

<p>In one-dimensional functions, the slope is the instantaneous rate of 
change of the function at any point you might be interested in. The 
gradient is a generalization of slope for functions that don’t take a 
single number but a vector of numbers. Additionally, the gradient is 
just a vector of slopes (more commonly referred to as <strong>derivatives</strong>)
 for each dimension in the input space. The mathematical expression for 
the derivative of a 1-D function with respect its input is:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 15.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.779em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.044em, 1011.78em, 3.477em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="mfrac" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 2.184em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.163em, 1002.02em, 4.342em, -1000em); top: -4.667em; left: 50%; margin-left: -1.032em;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-447" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-448" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-449" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-450" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.163em, 1000.97em, 4.148em, -1000em); top: -3.304em; left: 50%; margin-left: -0.487em;"><span class="mrow" id="MathJax-Span-451"><span class="mi" id="MathJax-Span-452" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-453" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1002.18em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.184em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-454" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-455" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1001.33em, 4.135em, -1000em); top: -3.99em; left: 0.102em;"><span class="mo" id="MathJax-Span-456" style="font-family: STIXGeneral;">lim</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1001.52em, 4.245em, -1000em); top: -3.315em; left: 0em;"><span class="texatom" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="mi" id="MathJax-Span-459" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mtext" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral;">→</span><span class="mn" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXGeneral;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-463" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 6.064em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.163em, 1005.9em, 4.342em, -1000em); top: -4.667em; left: 50%; margin-left: -2.972em;"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-466" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-467" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-468" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-469" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">h</span><span class="mo" id="MathJax-Span-470" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-471" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-472" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.25em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-473" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-474" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-475" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.163em, 1000.48em, 4.144em, -1000em); top: -3.304em; left: 50%; margin-left: -0.25em;"><span class="mi" id="MathJax-Span-476" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1006.06em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.064em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.083em; border-left: 0px solid; width: 0px; height: 2.913em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>d</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mo>=</mo><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mtext>&nbsp;</mtext><mo stretchy="false">→</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mi>h</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">\frac{df(x)}{dx} = \lim_{h\ \to 0} \frac{f(x + h) - f(x)}{h}</script>

<p>When the functions of interest take a vector of numbers instead of a single number, we call the derivatives <strong>partial derivatives</strong>, and the gradient is simply the vector of partial derivatives in each dimension.</p>

<p><a name="gradcompute"></a></p>

<h3 id="computing-the-gradient">Computing the gradient</h3>

<p>There are two ways to compute the gradient: A slow, approximate but easy way (<strong>numerical gradient</strong>), and a fast, exact but more error-prone way that requires calculus (<strong>analytic gradient</strong>). We will now present both.</p>

<p><a name="numerical"></a></p>

<h4 id="computing-the-gradient-numerically-with-finite-differences">Computing the gradient numerically with finite differences</h4>

<p>The formula given above allows us to compute the gradient numerically. Here is a generic function that takes a function <code class="highlighter-rouge">f</code>, a vector <code class="highlighter-rouge">x</code> to evaluate the gradient on, and returns the gradient of <code class="highlighter-rouge">f</code> at <code class="highlighter-rouge">x</code>:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">eval_numerical_gradient</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
  <span class="s">""" 
  a naive implementation of numerical gradient of f at x 
  - f should be a function that takes a single argument
  - x is the point (numpy array) to evaluate the gradient at
  """</span> 

  <span class="n">fx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c"># evaluate function value at original point</span>
  <span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">h</span> <span class="o">=</span> <span class="mf">0.00001</span>

  <span class="c"># iterate over all indexes in x</span>
  <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nditer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="p">[</span><span class="s">'multi_index'</span><span class="p">],</span> <span class="n">op_flags</span><span class="o">=</span><span class="p">[</span><span class="s">'readwrite'</span><span class="p">])</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="n">it</span><span class="o">.</span><span class="n">finished</span><span class="p">:</span>

    <span class="c"># evaluate function at x+h</span>
    <span class="n">ix</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">multi_index</span>
    <span class="n">old_value</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_value</span> <span class="o">+</span> <span class="n">h</span> <span class="c"># increment by h</span>
    <span class="n">fxh</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c"># evalute f(x + h)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_value</span> <span class="c"># restore to previous value (very important!)</span>

    <span class="c"># compute the partial derivative</span>
    <span class="n">grad</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fxh</span> <span class="o">-</span> <span class="n">fx</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span> <span class="c"># the slope</span>
    <span class="n">it</span><span class="o">.</span><span class="n">iternext</span><span class="p">()</span> <span class="c"># step to next dimension</span>

  <span class="k">return</span> <span class="n">grad</span>
</code></pre>
</div>

<p>Following the gradient formula we gave above, the code above iterates over all dimensions one by one, makes a small change <code class="highlighter-rouge">h</code>
 along that dimension and calculates the partial derivative of the loss 
function along that dimension by seeing how much the function changed. 
The variable <code class="highlighter-rouge">grad</code> holds the full gradient in the end.</p>

<p><strong>Practical considerations</strong>. Note that in the mathematical formulation the gradient is defined in the limit as <strong>h</strong>
 goes towards zero, but in practice it is often sufficient to use a very
 small value (such as 1e-5 as seen in the example). Ideally, you want to
 use the smallest step size that does not lead to numerical issues. 
Additionally, in practice it often works better to compute the numeric 
gradient using the <strong>centered difference formula</strong>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-477" style="width: 12.31em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.471em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.721em, 1009.45em, 2.899em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-478"><span class="mo" id="MathJax-Span-479" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-480" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-481" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-482" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-483" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-484" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">h</span><span class="mo" id="MathJax-Span-485" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-486" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-487" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.25em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-488" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-489" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-490" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-491" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">h</span><span class="mo" id="MathJax-Span-492" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-493" style="font-family: STIXGeneral;">]</span><span class="texatom" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mo" id="MathJax-Span-496" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-497" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-498" style="font-family: STIXGeneral; font-style: italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.332em; border-left: 0px solid; width: 0px; height: 1.282em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>h</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-31"> [f(x+h) - f(x-h)] / 2 h </script> . See <a href="http://en.wikipedia.org/wiki/Numerical_differentiation">wiki</a> for details.</p>

<p>We can use the function given above to compute the gradient at any 
point and for any function. Lets compute the gradient for the CIFAR-10 
loss function at some random point in the weight space:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="c"># to use the generic code above we want a function that takes a single argument</span>
<span class="c"># (the weights in our case) so we close over X_train and Y_train</span>
<span class="k">def</span> <span class="nf">CIFAR10_loss_fun</span><span class="p">(</span><span class="n">W</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">L</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3073</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="c"># random weight vector</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">eval_numerical_gradient</span><span class="p">(</span><span class="n">CIFAR10_loss_fun</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="c"># get the gradient</span>
</code></pre>
</div>

<p>The gradient tells us the slope of the loss function along every dimension, which we can use to make an update:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">loss_original</span> <span class="o">=</span> <span class="n">CIFAR10_loss_fun</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="c"># the original loss</span>
<span class="k">print</span> <span class="s">'original loss: </span><span class="si">%</span><span class="s">f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">loss_original</span><span class="p">,</span> <span class="p">)</span>

<span class="c"># lets see the effect of multiple step sizes</span>
<span class="k">for</span> <span class="n">step_size_log</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
  <span class="n">step_size</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">step_size_log</span>
  <span class="n">W_new</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">df</span> <span class="c"># new position in the weight space</span>
  <span class="n">loss_new</span> <span class="o">=</span> <span class="n">CIFAR10_loss_fun</span><span class="p">(</span><span class="n">W_new</span><span class="p">)</span>
  <span class="k">print</span> <span class="s">'for step size </span><span class="si">%</span><span class="s">f new loss: </span><span class="si">%</span><span class="s">f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">step_size</span><span class="p">,</span> <span class="n">loss_new</span><span class="p">)</span>

<span class="c"># prints:</span>
<span class="c"># original loss: 2.200718</span>
<span class="c"># for step size 1.000000e-10 new loss: 2.200652</span>
<span class="c"># for step size 1.000000e-09 new loss: 2.200057</span>
<span class="c"># for step size 1.000000e-08 new loss: 2.194116</span>
<span class="c"># for step size 1.000000e-07 new loss: 2.135493</span>
<span class="c"># for step size 1.000000e-06 new loss: 1.647802</span>
<span class="c"># for step size 1.000000e-05 new loss: 2.844355</span>
<span class="c"># for step size 1.000000e-04 new loss: 25.558142</span>
<span class="c"># for step size 1.000000e-03 new loss: 254.086573</span>
<span class="c"># for step size 1.000000e-02 new loss: 2539.370888</span>
<span class="c"># for step size 1.000000e-01 new loss: 25392.214036</span>
</code></pre>
</div>

<p><strong>Update in negative gradient direction</strong>. In the code above, notice that to compute <code class="highlighter-rouge">W_new</code> we are making an update in the negative direction of the gradient <code class="highlighter-rouge">df</code> since we wish our loss function to decrease, not increase.</p>

<p><strong>Effect of step size</strong>. The gradient tells us the 
direction in which the function has the steepest rate of increase, but 
it does not tell us how far along this direction we should step. As we 
will see later in the course, choosing the step size (also called the <em>learning rate</em>)
 will become one of the most important (and most headache-inducing) 
hyperparameter settings in training a neural network. In our blindfolded
 hill-descent analogy, we feel the hill below our feet sloping in some 
direction, but the step length we should take is uncertain. If we 
shuffle our feet carefully we can expect to make consistent but very 
small progress (this corresponds to having a small step size). 
Conversely, we can choose to make a large, confident step in an attempt 
to descend faster, but this may not pay off. As you can see in the code 
example above, at some point taking a bigger step gives a higher loss as
 we “overstep”.</p>

<div class="fig figleft fighighlight">
  <img src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/stepsize.jpg">
  <div class="figcaption">
    Visualizing the effect of step size. We start at some particular 
spot W and evaluate the gradient (or rather its negative - the white 
arrow) which tells us the direction of the steepest decrease in the loss
 function. Small steps are likely to lead to consistent but slow 
progress. Large steps can lead to better progress but are more risky. 
Note that eventually, for a large step size we will overshoot and make 
the loss worse. The step size (or as we will later call it - the <b>learning rate</b>) will become one of the most important hyperparameters that we will have to carefully tune.
  </div>
  <div style="clear:both;"></div>
</div>

<p><strong>A problem of efficiency</strong>. You may have noticed that 
evaluating the numerical gradient has complexity linear in the number of
 parameters. In our example we had 30730 parameters in total and 
therefore had to perform 30,731 evaluations of the loss function to 
evaluate the gradient and to perform only a single parameter update. 
This problem only gets worse, since modern Neural Networks can easily 
have tens of millions of parameters. Clearly, this strategy is not 
scalable and we need something better.</p>

<p><a name="analytic"></a></p>

<h4 id="computing-the-gradient-analytically-with-calculus">Computing the gradient analytically with Calculus</h4>

<p>The numerical gradient is very simple to compute using the finite 
difference approximation, but the downside is that it is approximate 
(since we have to pick a small value of <em>h</em>, while the true gradient is defined as the limit as <em>h</em>
 goes to zero), and that it is very computationally expensive to 
compute. The second way to compute the gradient is analytically using 
Calculus, which allows us to derive a direct formula for the gradient 
(no approximations) that is also very fast to compute. However, unlike 
the numerical gradient it can be more error prone to implement, which is
 why in practice it is very common to compute the analytic gradient and 
compare it to the numerical gradient to check the correctness of your 
implementation. This is called a <strong>gradient check</strong>.</p>

<p>Lets use the example of the SVM loss function for a single datapoint:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-499" style="width: 19.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.663em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(2.102em, 1014.47em, 4.792em, -1000em); top: -3.221em; left: 0em;"><span class="mrow" id="MathJax-Span-500"><span class="msubsup" id="MathJax-Span-501"><span style="display: inline-block; position: relative; width: 0.828em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mi" id="MathJax-Span-503" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-504" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-505" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.2em, 4.61em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-506" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1001.19em, 4.411em, -1000em); top: -2.84em; left: 0.052em;"><span class="texatom" id="MathJax-Span-507"><span class="mrow" id="MathJax-Span-508"><span class="mi" id="MathJax-Span-509" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-size: 70.7%; font-family: STIXGeneral;">≠</span><span class="msubsup" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-512" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-513" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mrow" id="MathJax-Span-514" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-515" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">[</span></span></span><span class="mrow" id="MathJax-Span-516"><span class="mo" id="MathJax-Span-517" style="font-family: STIXGeneral;">max</span><span class="mo" id="MathJax-Span-518" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-519" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-520" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-521" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-522" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.385em, 1000.27em, 4.281em, -1000em); top: -3.694em; left: 0.667em;"><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-526" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-527" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-528" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-529" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-531" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.58em, 4.311em, -1000em); top: -3.843em; left: 0.667em;"><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="msubsup" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-535" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-536" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-537"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-538" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-539" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-540" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-541" style="font-family: STIXGeneral; padding-left: 0.25em;">Δ</span><span class="mo" id="MathJax-Span-542" style="font-family: STIXGeneral;">)</span></span><span class="mo" id="MathJax-Span-543" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.917em; border-left: 0px solid; width: 0px; height: 3.247em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></munder><mrow><mo>[</mo><mrow><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">L_i = \sum_{j\neq y_i} \left[ \max(0, w_j^Tx_i - w_{y_i}^Tx_i + \Delta) \right]</script>

<p>We can differentiate the function with respect to the weights. For example, taking the gradient with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-544" style="width: 1.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.25em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1001.25em, 2.634em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-545"><span class="msubsup" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-547" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.667em;"><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="msubsup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-552" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.487em; border-left: 0px solid; width: 0px; height: 1.122em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">w_{y_i}</script> we obtain:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn mathvariant=&quot;double-struck&quot;&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-553" style="width: 24.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.654em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(2.251em, 1018.65em, 5.753em, -1000em); top: -4.183em; left: 0em;"><span class="mrow" id="MathJax-Span-554"><span class="msubsup" id="MathJax-Span-555"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.67em, 4.147em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-556" style="font-family: STIXGeneral;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.731em;"><span class="texatom" id="MathJax-Span-557"><span class="mrow" id="MathJax-Span-558"><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.46em, 4.147em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-560" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.884em; left: 0.472em;"><span class="texatom" id="MathJax-Span-561"><span class="mrow" id="MathJax-Span-562"><span class="msubsup" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0.399em; height: 0px;"><span style="position: absolute; clip: rect(3.626em, 1000.21em, 4.238em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.222em;"><span class="mi" id="MathJax-Span-565" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 0.828em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-567" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mi" id="MathJax-Span-568" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-569" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-570" style="font-family: STIXGeneral; padding-left: 0.313em;">−</span><span class="mrow" id="MathJax-Span-571" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-572" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">(</span></span><span class="mrow" id="MathJax-Span-573"><span class="munderover" id="MathJax-Span-574"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.2em, 4.61em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-575" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1001.19em, 4.411em, -1000em); top: -2.84em; left: 0.052em;"><span class="texatom" id="MathJax-Span-576"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-579" style="font-size: 70.7%; font-family: STIXGeneral;">≠</span><span class="msubsup" id="MathJax-Span-580"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-581" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-582" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-583" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-584"><span class="mn" id="MathJax-Span-585" style="font-family: STIXGeneral;">𝟙</span></span></span><span class="mo" id="MathJax-Span-586" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-588" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-589" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.385em, 1000.27em, 4.281em, -1000em); top: -3.694em; left: 0.667em;"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-591"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-592" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-594" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-595" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-596" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-597" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.58em, 4.311em, -1000em); top: -3.843em; left: 0.667em;"><span class="texatom" id="MathJax-Span-598"><span class="mrow" id="MathJax-Span-599"><span class="msubsup" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-601" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-602" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-604" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-606" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-607" style="font-family: STIXGeneral; padding-left: 0.25em;">Δ</span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral; padding-left: 0.313em;">&gt;</span><span class="mn" id="MathJax-Span-609" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span><span class="mo" id="MathJax-Span-610" style="font-family: STIXGeneral;">)</span></span><span class="mo" id="MathJax-Span-611" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">)</span></span></span><span class="msubsup" id="MathJax-Span-612" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-613" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-614" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.917em; border-left: 0px solid; width: 0px; height: 4.303em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow></msub></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mrow><mo>(</mo><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo stretchy="false">(</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><msub><mi>x</mi><mi>i</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">\nabla_{w_{y_i}} L_i = - \left( \sum_{j\neq y_i} \mathbb{1}(w_j^Tx_i - w_{y_i}^Tx_i + \Delta > 0) \right) x_i</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn mathvariant=&quot;double-struck&quot;&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-615" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.711em, 1000.34em, 2.692em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-616"><span class="texatom" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="mn" id="MathJax-Span-619" style="font-family: STIXGeneral;">𝟙</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow></math></span></span><script type="math/tex" id="MathJax-Element-35">\mathbb{1}</script>
 is the indicator function that is one if the condition inside is true 
or zero otherwise. While the expression may look scary when it is 
written out, when you’re implementing this in code you’d simply count 
the number of classes that didn’t meet the desired margin (and hence 
contributed to the loss function) and then the data vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" style="width: 0.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.578em, 1000.72em, 2.465em, -1000em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-621"><span class="msubsup" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-623" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-624" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.903em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">x_i</script> scaled by this number is the gradient. Notice that this is the gradient only with respect to the row of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-625" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.751em, 1000.91em, 2.71em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.997em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">W</script> that corresponds to the correct class. For the other rows where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-628" style="width: 3.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.742em, 1002.31em, 2.899em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-631" style="font-family: STIXGeneral; padding-left: 0.313em;">≠</span><span class="msubsup" id="MathJax-Span-632" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.43em, 4.341em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-633" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.332em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">j \neq y_i </script> the gradient is:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn mathvariant=&quot;double-struck&quot;&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-635" style="width: 18.512em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.231em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.598em, 1014.23em, 3.135em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-636"><span class="msubsup" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 1.47em; height: 0px;"><span style="position: absolute; clip: rect(3.184em, 1000.67em, 4.147em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-638" style="font-family: STIXGeneral;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.731em;"><span class="texatom" id="MathJax-Span-639"><span class="mrow" id="MathJax-Span-640"><span class="msubsup" id="MathJax-Span-641"><span style="display: inline-block; position: relative; width: 0.664em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.46em, 4.147em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-642" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.884em; left: 0.472em;"><span class="mi" id="MathJax-Span-643" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-644"><span style="display: inline-block; position: relative; width: 0.828em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.56em, 4.135em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-645" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.556em;"><span class="mi" id="MathJax-Span-646" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-647" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-648" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-649"><span class="mn" id="MathJax-Span-650" style="font-family: STIXGeneral;">𝟙</span></span></span><span class="mo" id="MathJax-Span-651" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-654" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.385em, 1000.27em, 4.281em, -1000em); top: -3.694em; left: 0.667em;"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-656"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-657" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-658" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-659" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-660" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.65em, 4.153em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-661" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.135em, -1000em); top: -4.335em; left: 0.667em;"><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.58em, 4.311em, -1000em); top: -3.843em; left: 0.667em;"><span class="texatom" id="MathJax-Span-663"><span class="mrow" id="MathJax-Span-664"><span class="msubsup" id="MathJax-Span-665"><span style="display: inline-block; position: relative; width: 0.506em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.3em, 4.28em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-666" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.314em;"><span class="mi" id="MathJax-Span-667" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-671" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-672" style="font-family: STIXGeneral; padding-left: 0.25em;">Δ</span><span class="mo" id="MathJax-Span-673" style="font-family: STIXGeneral; padding-left: 0.313em;">&gt;</span><span class="mn" id="MathJax-Span-674" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span><span class="mo" id="MathJax-Span-675" style="font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-676"><span style="display: inline-block; position: relative; width: 0.716em; height: 0px;"><span style="position: absolute; clip: rect(3.405em, 1000.45em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-677" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.444em;"><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.638em; border-left: 0px solid; width: 0px; height: 1.749em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>w</mi><mi>j</mi></msub></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo stretchy="false">(</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\nabla_{w_j} L_i = \mathbb{1}(w_j^Tx_i - w_{y_i}^Tx_i + \Delta > 0) x_i</script>

<p>Once you derive the expression for the gradient it is 
straight-forward to implement the expressions and use them to perform 
the gradient update.</p>

<p><a name="gd"></a></p>

<h3 id="gradient-descent">Gradient Descent</h3>

<p>Now that we can compute the gradient of the loss function, the 
procedure of repeatedly evaluating the gradient and then performing a 
parameter update is called <em>Gradient Descent</em>. Its <strong>vanilla</strong> version looks as follows:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Vanilla Gradient Descent</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">weights_grad</span> <span class="o">=</span> <span class="n">evaluate_gradient</span><span class="p">(</span><span class="n">loss_fun</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
  <span class="n">weights</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">weights_grad</span> <span class="c"># perform parameter update</span>
</code></pre>
</div>

<p>This simple loop is at the core of all Neural Network libraries. 
There are other ways of performing the optimization (e.g. LBFGS), but 
Gradient Descent is currently by far the most common and established way
 of optimizing Neural Network loss functions. Throughout the class we 
will put some bells and whistles on the details of this loop (e.g. the 
exact details of the update equation), but the core idea of following 
the gradient until we’re happy with the results will remain the same.</p>

<p><strong>Mini-batch gradient descent.</strong> In large-scale 
applications (such as the ILSVRC challenge), the training data can have 
on order of millions of examples. Hence, it seems wasteful to compute 
the full loss function over the entire training set in order to perform 
only a single parameter update. A very common approach to addressing 
this challenge is to compute the gradient over <strong>batches</strong> 
of the training data. For example, in current state of the art ConvNets,
 a typical batch contains 256 examples from the entire training set of 
1.2 million. This batch is then used to perform a parameter update:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Vanilla Minibatch Gradient Descent</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">data_batch</span> <span class="o">=</span> <span class="n">sample_training_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span> <span class="c"># sample 256 examples</span>
  <span class="n">weights_grad</span> <span class="o">=</span> <span class="n">evaluate_gradient</span><span class="p">(</span><span class="n">loss_fun</span><span class="p">,</span> <span class="n">data_batch</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
  <span class="n">weights</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">weights_grad</span> <span class="c"># perform parameter update</span>
</code></pre>
</div>

<p>The reason this works well is that the examples in the training data 
are correlated. To see this, consider the extreme case where all 1.2 
million images in ILSVRC are in fact made up of exact duplicates of only
 1000 unique images (one for each class, or in other words 1200 
identical copies of each image). Then it is clear that the gradients we 
would compute for all 1200 identical copies would all be the same, and 
when we average the data loss over all 1.2 million images we would get 
the exact same loss as if we only evaluated on a small subset of 1000. 
In practice of course, the dataset would not contain duplicate images, 
the gradient from a mini-batch is a good approximation of the gradient 
of the full objective. Therefore, much faster convergence can be 
achieved in practice by evaluating the mini-batch gradients to perform 
more frequent parameter updates.</p>

<p>The extreme case of this is a setting where the mini-batch contains only a single example. This process is called <strong>Stochastic Gradient Descent (SGD)</strong> (or also sometimes <strong>on-line</strong>
 gradient descent). This is relatively less common to see because in 
practice due to vectorized code optimizations it can be computationally 
much more efficient to evaluate the gradient for 100 examples, than the 
gradient for one example 100 times. Even though SGD technically refers 
to using a single example at a time to evaluate the gradient, you will 
hear people use the term SGD even when referring to mini-batch gradient 
descent (i.e. mentions of MGD for “Minibatch Gradient Descent”, or BGD 
for “Batch gradient descent” are rare to see), where it is usually 
assumed that mini-batches are used. The size of the mini-batch is a 
hyperparameter but it is not very common to cross-validate it. It is 
usually based on memory constraints (if any), or set to some value, e.g.
 32, 64 or 128. We use powers of 2 in practice because many vectorized 
operation implementations work faster when their inputs are sized in 
powers of 2.</p>

<p><a name="summary"></a></p>

<h3 id="summary">Summary</h3>

<div class="fig figcenter fighighlight">
  <img src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/dataflow.jpeg">
  <div class="figcaption">
    Summary of the information flow. The dataset of pairs of <b>(x,y)</b>
 is given and fixed. The weights start out as random numbers and can 
change. During the forward pass the score function computes class 
scores, stored in vector <b>f</b>. The loss function contains two components: The data loss computes the compatibility between the scores <b>f</b> and the labels <b>y</b>.
 The regularization loss is only a function of the weights. During 
Gradient Descent, we compute the gradient on the weights (and optionally
 on data if we wish) and use them to perform a parameter update during 
Gradient Descent.
  </div>
</div>

<p>In this section,</p>

<ul>
  <li>We developed the intuition of the loss function as a <strong>high-dimensional optimization landscape</strong>
 in which we are trying to reach the bottom. The working analogy we 
developed was that of a blindfolded hiker who wishes to reach the 
bottom. In particular, we saw that the SVM cost function is piece-wise 
linear and bowl-shaped.</li>
  <li>We motivated the idea of optimizing the loss function with
<strong>iterative refinement</strong>, where we start with a random set of weights and refine them step by step until the loss is minimized.</li>
  <li>We saw that the <strong>gradient</strong> of a function gives the 
steepest ascent direction and we discussed a simple but inefficient way 
of computing it numerically using the finite difference approximation 
(the finite difference being the value of <em>h</em> used in computing the numerical gradient).</li>
  <li>We saw that the parameter update requires a tricky setting of the <strong>step size</strong> (or the <strong>learning rate</strong>)
 that must be set just right: if it is too low the progress is steady 
but slow. If it is too high the progress can be faster, but more risky. 
We will explore this tradeoff in much more detail in future sections.</li>
  <li>We discussed the tradeoffs between computing the <strong>numerical</strong> and <strong>analytic</strong>
 gradient. The numerical gradient is simple but it is approximate and 
expensive to compute. The analytic gradient is exact, fast to compute 
but more error-prone since it requires the derivation of the gradient 
with math. Hence, in practice we always use the analytic gradient and 
then perform a <strong>gradient check</strong>, in which its implementation is compared to the numerical gradient.</li>
  <li>We introduced the <strong>Gradient Descent</strong> algorithm which iteratively computes the gradient and performs a parameter update in loop.</li>
</ul>

<p><strong>Coming up:</strong> The core takeaway from this section is 
that the ability to compute the gradient of a loss function with respect
 to its weights (and have some intuitive understanding of it) is the 
most important skill needed to design, train and understand neural 
networks. In the next section we will develop proficiency in computing 
the gradient analytically using the chain rule, otherwise also referred 
to as <strong>backpropagation</strong>. This will allow us to 
efficiently optimize relatively arbitrary loss functions that express 
all kinds of Neural Networks, including Convolutional Neural Networks.</p>


  </article>

</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <div class="footer-col-1 column">
      <ul>
        
        <li>
          <a href="https://github.com/cs231n">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path>
              </svg>
            </span>
            <span class="username">cs231n</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/cs231n">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path>
              </svg>
            </span>
            <span class="username">cs231n</span>
          </a>
        </li>
        <li>
          <a href="mailto:karpathy@cs.stanford.edu">karpathy@cs.stanford.edu</a>
        </li>
      </ul>
    </div>

    <div class="footer-col-2 column">
        
    </div>

    <div class="footer-col-3 column">
      
    </div>

  </div>

</footer>


    <!-- mathjax -->
    <script type="text/javascript" src="4%20CS231n%20Convolutional%20Neural%20Networks%20for%20Visual%20Recognition_files/MathJax.js"></script>
    
<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: STIXSizeOneSym,sans-serif;"></div></div></body></html>